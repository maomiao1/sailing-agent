# ✅ 部署检查清单

部署前请逐项检查，确保所有步骤都已完成。

---

## 📋 部署前准备

### 1. 代码检查
- [ ] 所有功能测试正常（创建项目、上传手册、生成内容）
- [ ] 没有明显的错误或警告
- [ ] 本地运行 `npm run build` 成功

### 2. 环境变量准备
- [ ] `.env.local` 文件包含以下3个变量：
  - [ ] `NEXT_PUBLIC_SUPABASE_URL`
  - [ ] `NEXT_PUBLIC_SUPABASE_ANON_KEY`
  - [ ] `GEMINI_API_KEY`
- [ ] 复制这3个变量的值，准备在 Vercel 中使用

### 3. GitHub 仓库
- [ ] 已创建 GitHub 仓库
- [ ] 代码已推送到 main 分支
- [ ] `.env.local` 文件已被 `.gitignore` 忽略（不会上传）

---

## 🚀 Vercel 部署步骤

### 步骤 1: 登录 Vercel
- [ ] 访问 https://vercel.com
- [ ] 使用 GitHub 账号登录
- [ ] 授权 Vercel 访问你的仓库

### 步骤 2: 导入项目
- [ ] 点击 "Add New..." → "Project"
- [ ] 找到 `sailing-agent` 仓库
- [ ] 点击 "Import"

### 步骤 3: 配置项目
- [ ] Framework Preset: Next.js（自动检测）
- [ ] Root Directory: `.`（默认）
- [ ] Build Command: `npm run build`（自动设置）

### 步骤 4: 添加环境变量
在 "Environment Variables" 部分添加：

- [ ] `NEXT_PUBLIC_SUPABASE_URL` = [从 .env.local 复制]
- [ ] `NEXT_PUBLIC_SUPABASE_ANON_KEY` = [从 .env.local 复制]
- [ ] `GEMINI_API_KEY` = [从 .env.local 复制]

**重要**: 每个变量都要勾选：
- [ ] Production
- [ ] Preview
- [ ] Development

### 步骤 5: 部署
- [ ] 点击 "Deploy" 按钮
- [ ] 等待 2-3 分钟
- [ ] 看到 "Congratulations" 页面

---

## ✅ 部署后验证

### 1. 访问网站
- [ ] 打开 Vercel 提供的 Production URL（如 `https://sailing-agent-xxx.vercel.app`）
- [ ] 首页正常显示
- [ ] 样式正确加载

### 2. 测试核心功能
- [ ] 可以创建新项目
- [ ] 可以上传航海手册（试试 .txt 或 .docx）
- [ ] 可以生成详情页
- [ ] 可以生成开船第一课（需要先生成详情页）
- [ ] 可以编辑和复制内容

### 3. 检查日志
- [ ] Vercel 项目页面没有错误日志
- [ ] Supabase Dashboard 显示有数据写入
- [ ] 浏览器控制台没有错误

---

## 🎯 部署完成后

### 分享给团队
- [ ] 复制 Production URL
- [ ] 分享给需要使用的人
- [ ] 说明使用方法

### 可选：绑定自定义域名
- [ ] 在 Vercel 项目设置中添加域名
- [ ] 在域名提供商处添加 DNS 记录
- [ ] 等待 DNS 生效

### 可选：设置监控
- [ ] 在 Vercel 中查看使用情况
- [ ] 在 Supabase 中查看数据库使用情况
- [ ] 监控 Gemini API 使用量

---

## 📝 重要提醒

### 修改模板不需要重新部署
如果需要修改生成模板（如开船第一课、航线图等），只需：

1. 在本地修改对应的脚本文件（如 `update-first-lesson-template-v2.js`）
2. 运行脚本：
   ```bash
   node update-first-lesson-template-v2.js
   ```
3. ✅ 修改立即生效，**无需重新部署**

原因：模板存储在 Supabase 数据库中，修改数据库后网站自动使用新模板。

### 何时需要重新部署
只有以下情况需要重新部署（会自动触发）：
- 修改了代码（.tsx、.ts、.css 等文件）
- 推送到 GitHub 的 main 分支

---

## 🆘 遇到问题？

### 常见问题速查
- **构建失败**: 检查本地是否能运行 `npm run build`
- **404 错误**: 检查 Vercel 项目设置中的 Root Directory
- **API 调用失败**: 检查环境变量是否正确配置
- **Supabase 连接失败**: 检查 URL 和 Key 是否正确

### 查看详细日志
- Vercel: 项目页面 → "Deployments" → 选择部署 → 查看日志
- Supabase: Dashboard → Logs
- 浏览器: 按 F12 → Console 标签

---

## 🎉 恭喜！

完成所有检查项后，你的 Sailing Agent 就成功部署了！

**Production URL**: ___________________________（填写你的网址）

**部署时间**: ___________________________

**部署人**: ___________________________

---

**详细文档**: 参考 [DEPLOYMENT.md](./DEPLOYMENT.md)
